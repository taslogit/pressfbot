# Аудит витрины магазина (XP/REP Store)

Проверка: все ли товары из каталога реализованы (покупка + применение + отображение в UI).

---

## ✅ Полностью реализованы

| ID | Название | Покупка | Применение | UI |
|----|----------|---------|------------|-----|
| **avatar_*** | Аватары (из папки static/avatars) | ✓ | Запись в store_purchases | ✓ Выбор в Профиле по ownedAvatarIds |
| **avatar_frame_fire/diamond/neon/gold** | Рамки аватара | ✓ | user_settings.avatar_frame | ✓ Выбор рамки в Профиле, проверка владения |
| **xp_boost_2x** | 2x XP (24ч) | ✓ | activateBoost → user_active_boosts | ✓ Учитывается в начислении XP |
| **streak_shield** | Защита стрика | ✓ | user_settings.streak_free_skip += 1 | ✓ Учитывается при пропуске дня |

---

## ⚠️ Частично реализованы (покупка есть, эффект/UI неполные)

| ID | Название | Что есть | Чего не хватает |
|----|----------|----------|------------------|
| **title_custom** | Кастомный титул | Покупка → achievements[itemId]=true. В профиле есть поле `title` в API. | В UI профиля показывается только **levelTitle** (из уровня). Нет поля для ввода/отображения своего титула и проверки достижения title_custom. |
| **bio_extended** | Расширенная био (500 символов) | Покупка → achievements. Био редактируется в профиле. | Нет проверки: при наличии bio_extended лимит 500, иначе 150. Сейчас лимит на длину bio нигде не задан. |
| **profile_theme_neon** / **profile_theme_gold** | Темы карточки профиля | Покупка → achievements. | Нет поля в профиле/настройках для темы карточки и нет стилей (neon/gold) в UI профиля. |
| **letter_template_basic_neon** / **letter_template_basic_retro** | Шаблоны писем | Покупка → achievements. | В CreateLetter нет выбора шаблона и нет стилей (neon/retro) для письма. |
| **exclusive_badge_veteran** / **exclusive_badge_legend** | Бейджи за REP | Покупка (за REP) → achievements. | Вкладка «Бейджи» в профиле показывает только статичный набор (first_letter, 10_letters, …). Магазинные бейджи из achievements не отображаются. |
| **duel_taunt** | Кастомный тролль при победе | Покупка → achievements. | В дуэлях нет поля «сообщение при победе» и нет отправки/показа этого сообщения при выигрыше. |

---

## ❌ Не реализованы (покупка без применения)

| ID | Название | Что есть | Что нужно |
|----|----------|----------|-----------|
| **extra_daily_quest** | Доп. ежедневный квест | Покупка записывается в store_purchases и achievements. | При покупке нужно добавлять пользователю **одну дополнительную квест-запись на сегодня** (та же логика, что в dailyQuests: INSERT в daily_quests). Сейчас в POST /buy и mystery-box для consumable обрабатываются только xp_boost_2x и streak_shield. |
| **free_gift_pack** | 3 бесплатных подарка | Покупка записывается. | При покупке нужно увеличивать «баланс» бесплатных подарков у пользователя (например поле в user_settings или профиле) или добавлять 3 единицы в доступные для отправки подарки. Сейчас такого применения нет. |
| **squad_banner** | Кастомный баннер отряда | Покупка → achievements. | В таблице squads нет поля banner_url. Нет UI загрузки/выбора баннера и отображения в карточке отряда. Нужны: миграция (banner_url), API обновления, UI в Squads. |

---

## Итог

- **Полностью реализованы:** аватары, рамки аватара, 2x XP, защита стрика.
- **Частично:** кастомный титул, расширенная био, темы профиля, шаблоны писем, бейджи за REP, тролль в дуэлях — покупка и запись в achievements есть, но в UI/логике не используются или не завершены.
- **Не реализованы:** extra_daily_quest (не добавляется квест), free_gift_pack (не начисляются подарки), squad_banner (нет поля и UI).

Рекомендация: сначала реализовать применение consumable **extra_daily_quest** и **free_gift_pack** на бэкенде (POST /buy и mystery-box), затем по желанию — кастомный титул и расширенную био в профиле (лимит по достижению), остальные пункты — по приоритету.
